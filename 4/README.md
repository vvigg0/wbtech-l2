# Задача l2.4

## Задание
Что выведет программа?

Объясните вывод программы.
```go
func main() {
  ch := make(chan int)
  go func() {
    for i := 0; i < 10; i++ {
    ch <- i
  }
}()
  for n := range ch {
    println(n)
  }
}
```

## Решение

Программа выведет:
```
0
1
2
3
4
5
6
7
8
9
fatal error: all goroutines are asleep - deadlock!
```

### Объяснение

Цикл чтения данных из канала через конструкцию `range` заканчивается, когда канал закрыт и в нем нет данных. В данном примере данных больше нет (анонимная горутина завершила свою работу), но канал не закрыт - горутина `main` ждёт данных, но их больше не будет,в итоге программа встала на месте,т.е `deadlock`.

#### Как исправить

```go
func main() {
  ch := make(chan int)
  go func() {
    for i := 0; i < 10; i++ {
    ch <- i
  }
  //================//
  close(ch)
  //================//
}()
  for n := range ch {
    println(n)
  }
}
```

Анонимная горутина закроет канал после того как внесёт в него все данные,а горутина `main` когда заберёт все данные из канала выйдет из цикла `range`, потому что есть флаг что данных больше не будет - **канал закрыт**. Программа завершится корректно